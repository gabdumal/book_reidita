---
title: Estado
author: Gabriel Malosto
---

import Figure from "/src/components/Figure.astro";

import actions from "/src/assets/content/docs/course/state/actions.png";

Agora que temos os bot√µes, precisamos implementar suas a√ß√µes.
A l√≥gica de coletar madeira √© simples: ao clicar no bot√£o, a quantidade de madeira deve aumentar.
Conclu√≠mos que deve haver uma vari√°vel para armazenar a quantidade de madeira.

A implementa√ß√£o trivial seria criar uma vari√°vel global para armazenar a quantidade de madeira.
No entanto, isso n√£o √© uma boa pr√°tica, pois vari√°veis globais podem causar problemas de manuten√ß√£o e escalabilidade.

Al√©m disso, podemos melhorar essa ideia ao n√£o somente armazenar a quantidade, mas tamb√©m representar cada recurso como um objeto.

## Tipos

Quando trabalhamos com objetos no TypeScript, √© uma boa pr√°tica antes definir uma interface que represente a forma do objeto.
Uma vez que esses tipos ser√£o usados por todo o projeto, √© melhor defini-los em um arquivo separado.

### Recurso

1. Crie um arquivo chamado `types.ts` na pasta `src`.
2. Adicione as seguintes interfaces ao arquivo:

```tsx
/* types.ts */

export interface Resource {
  name: string;
  icon: string;
}

export interface Resources {
  wood: Resource;
  coin: Resource;
}
```

3. Edite o componente `ResourceDisplay` para que ele receba um objeto do tipo `Resource` e a quantidade dele no estoque. Lembre-se de importar a interface `Resource` no in√≠cio do arquivo.

```tsx
/* ResourceDisplay.tsx */

interface ResourceDisplayProps {
  resource: Resource;
  amount: number;
}
```

4. Atualize os props recebidos pela fun√ß√£o que define o componente. Tamb√©m atualize o conte√∫do dos elementos `<h1>` e `<span>` para exibir o nome e o √≠cone do recurso, respectivamente.

```tsx
/* ResourceDisplay.tsx */

export default function ResourceDisplay({
  resource,
  amount,
}: ResourceDisplayProps) {
  return (
    <div className={styles.box}>
      <h1 className={styles.name}>{resource.name}</h1>
      <span className={styles.icon}>{resource.icon}</span>
      <p className={styles.amount}>{amount}</p>
    </div>
  );
}
```

5. Dentro da **fun√ß√£o** que define o componente `ResourcesContainer`, crie um objeto do tipo `Resource` para representar a madeira e outro para representar as moedas.

```tsx
/* ResourcesContainer.tsx */

export default function ResourcesContainer() {
  const wood: Resource = {
    name: "Madeira",
    icon: "üå≥",
  };

  const coin: Resource = {
    name: "Moeda",
    icon: "ü™ô",
  };

  // ...
}
```

6. Logo abaixo, crie um objeto do tipo `Resources` que inclua a madeira e as moedas.

```tsx
/* ResourcesContainer.tsx */

const resources: Resources = {
  wood,
  coin,
};
```

7. Atualize as chamadas do componente `ResourceDisplay` para que elas passem o recurso e a quantidade.

```tsx
/* ResourcesContainer.tsx */

return (
  <section className={styles.container}>
    <div className={styles.group}>
      <ResourceDisplay resource={resources.wood} amount={0} />
      <ResourceDisplay resource={resources.coin} amount={0} />
    </div>
  </section>
);
```

A p√°gina deve continuar exibindo os recursos da mesma forma que antes.
Apenas mudamos a forma como os recursos s√£o representados no c√≥digo.

### A√ß√£o

Vamos atualizar a representa√ß√£o das a√ß√µes da mesma forma que fizemos com os recursos.
Uma a√ß√£o √© um objeto que cont√©m um nome e rela√ß√µes entre recursos.
Por exemplo, uma a√ß√£o de vender madeira remove uma certa quantidade de madeira do estoque e adiciona uma certa quantidade de moedas.
Por isso, vamos criar dois tipos: troca e a√ß√£o.

1. Adicione as seguintes interfaces ao arquivo `types.ts`:

```tsx
/* types.ts */

export interface Trade {
  resource: Resource;
  quantity: number;
}

export interface Action {
  name: string;
  icon: string;
  trades: Trade[];
}

export interface Actions {
  chopWood: Action;
  sellWood: Action;
}
```

2. Edite o componente `ActionButton` para que ele receba um objeto do tipo `Action`.

```tsx
/* ActionButton.tsx */

interface ActionButtonProps {
  action: Action;
}
```

3. Atualize os props recebidos pela fun√ß√£o que define o componente. Tamb√©m atualize o conte√∫do dos elementos `<p>` e `<span>` para exibir o nome e o √≠cone da a√ß√£o, respectivamente.

```tsx
/* ActionButton.tsx */

export default function ActionButton({ action }: ActionButtonProps) {
  return (
    <div className={styles.box}>
      <p className={styles.name}>{action.name}</p>
      <button className={styles.button}>
        <span className={styles.icon}>{action.icon}</span>
      </button>
    </div>
  );
}
```

4. Dentro da **fun√ß√£o** que define o componente `ActionsContainer`, crie um objeto do tipo `Action` para representar as a√ß√µes de cortar madeira e vender madeira. Tamb√©m crie um objeto do tipo `Actions` que inclua essas a√ß√µes.

```tsx
/* ActionsContainer.tsx */

export default function ActionsContainer() {
  const chopWood: Action = {
    name: "Cortar Madeira",
    icon: "ü™ì",
    trades: [],
  };

  const sellWood: Action = {
    name: "Vender Madeira",
    icon: "üí∞",
    trades: [],
  };

  const actions: Actions = {
    chopWood,
    sellWood,
  };

  // ...
}
```

5. Atualize as chamadas do componente `ActionButton` para que elas passem as a√ß√µes.

```tsx
/* ActionsContainer.tsx */

return (
  <section className={styles.container}>
    <div className={styles.group}>
      <ActionButton action={actions.chopWood} />
      <ActionButton action={actions.sellWood} />
    </div>
  </section>
);
```

O resultado final deve ser como o seguinte:

<Figure
  caption={`Recursos "Madeira" e "Moeda", e bot√µes de a√ß√£o para cortar madeira e vender madeira.`}
  images={[
    {
      src: actions,
      alt: `P√°gina do projeto mostrando os recursos "Madeira" e "Moeda", e bot√µes de a√ß√£o para cortar e vender madeira, cada um com seu nome e √≠cone.`,
    },
  ]}
/>

## Eleva√ß√£o de estado

Voc√™ pode ter percebido que n√£o preenchemos o vetor de trocas das a√ß√µes.
Isso ocorre porque, para faz√™-lo, √© necess√°rio receber a lista de todos os recursos dispon√≠veis.
Entretanto, os recursos s√£o definidos no componente `ResourcesContainer`, e as a√ß√µes s√£o definidas no componente `ActionsContainer`, que s√£o irm√£os na hierarquia de componentes.
Em situa√ß√µes como essa, devemos **elevar o estado** para o componente pai em comum.

1. Remova a defini√ß√£o do objeto `resources` do componente `ResourcesContainer` e o mova para o componente `App`.

```tsx
/* App.tsx */

export default function App() {
  const wood: Resource = {
    name: "Madeira",
    icon: "üå≥",
  };

  const coin: Resource = {
    name: "Moeda",
    icon: "ü™ô",
  };

  const resources: Resources = {
    wood,
    coin,
  };

  // ...
}
```

2. Passe o objeto `resources` como propriedade para os componentes `ResourcesContainer` e `ActionsContainer`.

```tsx
/* App.tsx */

return (
  <article className={styles.container}>
    <Header />
    <ResourcesContainer resources={resources} />
    <ActionsContainer resources={resources} />
  </article>
);
```

3. Receba o objeto `resources` como propriedade no componente `ResourcesContainer`.

```tsx
/* ResourcesContainer.tsx */

interface ResourcesContainerProps {
  resources: Resources;
}

export default function ResourcesContainer({
  resources,
}: ResourcesContainerProps) {
  // ...
}
```

4. Receba o objeto `resources` como propriedade no componente `ActionsContainer`.

```tsx
/* ActionsContainer.tsx */

interface ActionsContainerProps {
  resources: Resources;
}

export default function ActionsContainer({ resources }: ActionsContainerProps) {
  // ...
}
```

5. Atualize as propriedades `trades` das a√ß√µes para que elas recebam a lista de recursos dispon√≠veis.

```tsx
/* ActionsContainer.tsx */

const chopWood: Action = {
  name: "Cortar Madeira",
  icon: "ü™ì",
  trades: [{ resource: resources.wood, quantity: +1 }],
};

const sellWood: Action = {
  name: "Vender Madeira",
  icon: "üí∞",
  trades: [
    { resource: resources.wood, quantity: -1 },
    { resource: resources.coin, quantity: +1 },
  ],
};
```

Voc√™ pode ter percebido que n√£o estamos armazenando a quantidade de recursos em lugar algum.
Isso ocorre porque a quantidade de recursos √© um estado compartilhado entre os componentes `ResourcesContainer` e `ActionsContainer`.

Esse componente √© o `App`, que √© o principal da aplica√ß√£o.
Dessa forma, ele √© local ideal para criar o objeto que representa o estoque de recursos.
